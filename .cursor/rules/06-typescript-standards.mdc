---
description: TypeScript and React coding standards for AISTRALE frontend
globs: frontend/**/*.{ts,tsx}
alwaysApply: true
---

# ðŸ“˜ AISTRALE TypeScript & React Standards

## BuildWorks-04001 TypeScript Configuration
- Use TypeScript 5 with strict mode enabled
- Enable all strict type checking options
- Use ESLint for linting
- Use Prettier for formatting

## BuildWorks-04002 React Component Standards
```typescript
// âœ… GOOD: Proper React component with TypeScript
import { useState, useEffect } from 'react';
import { useNavigate } from 'react-router-dom';

interface InferenceProps {
  model: string;
  onComplete?: (result: string) => void;
}

export function InferenceComponent({ model, onComplete }: InferenceProps) {
  const [loading, setLoading] = useState(false);
  const [result, setResult] = useState<string | null>(null);
  const navigate = useNavigate();

  useEffect(() => {
    // Component initialization
  }, []);

  const handleInference = async () => {
    setLoading(true);
    try {
      // Implementation
    } catch (error) {
      console.error('Inference failed:', error);
    } finally {
      setLoading(false);
    }
  };

  return (
    <div>
      {/* Component JSX */}
    </div>
  );
}
```

## BuildWorks-04003 Type Definitions
```typescript
// âœ… GOOD: Proper type definitions
// frontend/src/types/index.ts

export interface User {
  id: string;
  name: string;
  email: string;
  role: 'admin' | 'user';
  is_active: boolean;
  created_at: string;
}

export interface InferenceRequest {
  model: string;
  inputs: string;
  config?: Record<string, unknown>;
}

export interface InferenceResponse {
  output: string;
  tokens: number;
  duration: number;
  model: string;
  provider: 'huggingface' | 'openai';
}

export interface TelemetryRecord {
  id: string;
  model: string;
  provider: string;
  tokens: number;
  duration: number;
  status: 'success' | 'error';
  created_at: string;
}
```

## BuildWorks-04004 API Client Standards
```typescript
// âœ… GOOD: Type-safe API client
// frontend/src/lib/api.ts
import { InferenceRequest, InferenceResponse, User } from '@/types';

const API_URL = import.meta.env.VITE_API_URL || 'http://localhost:16000';

class ApiClient {
  private baseUrl: string;

  constructor(baseUrl: string) {
    this.baseUrl = baseUrl;
  }

  private async request<T>(
    endpoint: string,
    options?: RequestInit
  ): Promise<T> {
    const response = await fetch(`${this.baseUrl}${endpoint}`, {
      ...options,
      credentials: 'include', // Include cookies for session auth
      headers: {
        'Content-Type': 'application/json',
        ...options?.headers,
      },
    });

    if (!response.ok) {
      throw new Error(`API error: ${response.statusText}`);
    }

    return response.json();
  }

  async runInference(
    request: InferenceRequest
  ): Promise<InferenceResponse> {
    return this.request<InferenceResponse>('/api/v1/inference', {
      method: 'POST',
      body: JSON.stringify(request),
    });
  }

  async getCurrentUser(): Promise<User> {
    return this.request<User>('/api/v1/users/me');
  }
}

export const api = new ApiClient(API_URL);
```

## BuildWorks-04005 React Hooks Standards
```typescript
// âœ… GOOD: Custom hooks with proper typing
import { useState, useEffect } from 'react';
import { api } from '@/lib/api';
import { InferenceResponse } from '@/types';

export function useInference(model: string, inputs: string) {
  const [loading, setLoading] = useState(false);
  const [result, setResult] = useState<InferenceResponse | null>(null);
  const [error, setError] = useState<Error | null>(null);

  useEffect(() => {
    if (!model || !inputs) return;

    const runInference = async () => {
      setLoading(true);
      setError(null);
      try {
        const response = await api.runInference({ model, inputs });
        setResult(response);
      } catch (err) {
        setError(err as Error);
      } finally {
        setLoading(false);
      }
    };

    runInference();
  }, [model, inputs]);

  return { loading, result, error };
}
```

## BuildWorks-04006 Form Handling
```typescript
// âœ… GOOD: Form handling with validation
import { useState, FormEvent } from 'react';

interface FormData {
  model: string;
  inputs: string;
}

export function InferenceForm() {
  const [formData, setFormData] = useState<FormData>({
    model: '',
    inputs: '',
  });
  const [errors, setErrors] = useState<Partial<FormData>>({});

  const validate = (data: FormData): boolean => {
    const newErrors: Partial<FormData> = {};
    
    if (!data.model.trim()) {
      newErrors.model = 'Model is required';
    }
    
    if (!data.inputs.trim()) {
      newErrors.inputs = 'Inputs are required';
    }

    setErrors(newErrors);
    return Object.keys(newErrors).length === 0;
  };

  const handleSubmit = async (e: FormEvent) => {
    e.preventDefault();
    
    if (!validate(formData)) {
      return;
    }

    // Submit form
  };

  return (
    <form onSubmit={handleSubmit}>
      {/* Form fields */}
    </form>
  );
}
```

## BuildWorks-04007 Error Handling
```typescript
// âœ… GOOD: Error handling in React components
import { useState, useEffect } from 'react';
import { api } from '@/lib/api';

export function InferenceComponent() {
  const [error, setError] = useState<string | null>(null);

  const handleInference = async () => {
    try {
      setError(null);
      await api.runInference({ model: 'gpt-3.5-turbo', inputs: 'test' });
    } catch (err) {
      if (err instanceof Error) {
        setError(err.message);
      } else {
        setError('An unexpected error occurred');
      }
    }
  };

  return (
    <div>
      {error && (
        <div className="error-message" role="alert">
          {error}
        </div>
      )}
      {/* Component content */}
    </div>
  );
}
```

## BuildWorks-04008 Routing Standards
```typescript
// âœ… GOOD: React Router usage
import { BrowserRouter, Routes, Route, Navigate } from 'react-router-dom';
import Login from './pages/Login';
import Dashboard from './pages/Dashboard';
import Inference from './pages/Inference';

export function App() {
  return (
    <BrowserRouter>
      <Routes>
        <Route path="/login" element={<Login />} />
        <Route path="/" element={<Dashboard />} />
        <Route path="/inference" element={<Inference />} />
        <Route path="*" element={<Navigate to="/" />} />
      </Routes>
    </BrowserRouter>
  );
}
```

## BuildWorks-04009 Styling Standards
```typescript
// âœ… GOOD: Tailwind CSS usage
import { getBranding } from '@/lib/branding';

export function Button({ children, onClick }: ButtonProps) {
  const branding = getBranding();
  
  return (
    <button
      onClick={onClick}
      className="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500"
    >
      {children}
    </button>
  );
}
```

## BuildWorks-04010 Testing Standards (Future)
```typescript
// âœ… GOOD: Component testing with React Testing Library
import { render, screen, fireEvent } from '@testing-library/react';
import { InferenceComponent } from './InferenceComponent';

describe('InferenceComponent', () => {
  it('renders inference form', () => {
    render(<InferenceComponent model="gpt-3.5-turbo" />);
    expect(screen.getByLabelText(/model/i)).toBeInTheDocument();
  });

  it('handles form submission', async () => {
    render(<InferenceComponent model="gpt-3.5-turbo" />);
    const submitButton = screen.getByRole('button', { name: /submit/i });
    fireEvent.click(submitButton);
    // Assertions
  });
});
```

## BuildWorks-04011 Environment Variables
```typescript
// âœ… GOOD: Environment variable usage
// frontend/src/lib/config.ts

export const config = {
  apiUrl: import.meta.env.VITE_API_URL || 'http://localhost:16000',
  companyName: import.meta.env.VITE_COMPANY_NAME || 'BuildWorks.AI',
  productName: import.meta.env.VITE_PRODUCT_NAME || 'AISTRALE',
  productTagline: import.meta.env.VITE_PRODUCT_TAGLINE || 'Turn AI from a black box into an engineered system',
  websiteUrl: import.meta.env.VITE_WEBSITE_URL || 'https://aistrale.com',
  environment: import.meta.env.MODE || 'development',
};
```

## BuildWorks-04012 Code Organization
```
frontend/src/
â”œâ”€â”€ components/     # Reusable components
â”œâ”€â”€ pages/          # Page components
â”œâ”€â”€ lib/            # Utilities and helpers
â”œâ”€â”€ types/          # TypeScript type definitions
â”œâ”€â”€ hooks/          # Custom React hooks
â””â”€â”€ styles/         # Global styles
```

---

**Next Steps**: Review `05-code-quality.mdc` for code quality standards and `06-testing.mdc` for testing patterns.
